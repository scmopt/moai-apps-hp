# スケジューリング最適化ソルバー MOAI-scheduler ユーザーマニュアル

## 1. アプリケーション概要

本アプリケーションは、複数の工程（タスク）を、限られた設備や人員（リソース）に対して効率的に割り当てるためのスケジュールを作成します。
「どの作業を」「いつ」「どの設備で」行うかを自動判定し、納期遵守や総工期の短縮、段取り替え時間の最小化など、業務の実態に即した最適な作業計画を立案します。

## 2. 設定項目（入力データ）

### 2.1 案件・オーダー情報（Job）

複数の作業工程（Task）を束ねる、一つの注文やプロジェクト単位の情報を設定します。各Jobには、実行すべき一連のTaskが含まれます。

| 項目名 | 説明 | 入力上の注意 |
| --- | --- | --- |
| 案件名 | 受注番号やプロジェクト名。 | 識別しやすい名前を入力。 |
| 優先度 | 案件の重要度。数値が大きいほど優先されます。 | 0以上の値を入力してください。 |
| 着手可能日 | その案件の作業を開始できる最も早い日時。 | 0以上の値を入力してください。 |
| 最終完了期限 | 何があっても完了させなければならない絶対的な期限。 | 着手可能日以降の値を入力。 |
| 希望納期 | ペナルティなしで完了すべき目標日時。 | 期限を超えると遅延評価の対象となります。 |

### 2.2 設備・リソース情報（Resource）

作業に使用する設備、人員、資材などの特性を設定します。

| 項目名 | 説明 | 入力上の注意 |
| --- | --- | --- |
| リソース名 | 設備名、ライン名、職種名など。 | 識別しやすい名前を入力。 |
| リソース種別 | 「マシン（単一処理）」「反復利用（人員など）」「消耗型（資材など）」のいずれか。 | 業務上の性質に合わせて選択。 |
| 最大容量 | 同時に対応できる上限（人数、電力、資材残量など）。 | 「反復利用」「消耗型」の場合に必須。 |
| 非稼働時間帯 | メンテナンスや休憩など、作業ができない時間枠。 | 重複しない期間を指定してください。 |
| 連続稼働必須 | 作業終了後、設備を遊ばせずに即座に次を開始するか。 | 「マシン」種別のみ設定可能。 |

### 2.3 作業工程（Task）

具体的な作業単位の制約を設定します。

| 項目名 | 説明 | 入力上の注意 |
| --- | --- | --- |
| 工程名 | 「切削」「組立」「検査」などの作業名。 | 識別しやすい名前を入力。 |
| 着手時間枠 | 作業を開始できる「最も早い時間」と「最も遅い時間」。 | 指定がない場合は全期間が対象。 |
| 完了時間枠 | 作業を終了すべき「最も早い時間」と「最も遅い時間」。 | 指定がない場合は全期間が対象。 |
| 中断の許可 | リソースの休憩時間等に作業を一時中断して良いか。 | 許可しない場合は一括で処理されます。 |
| 待機の許可 | 作業完了後、次の工程までその場に留まれるか。 | 完了後即移動が必要な場合は設定。 |
| 任意フラグ | 必須ではない作業かどうか（オプション工程）。 | 有効な場合、計画から除外される事があります。 |

### 2.4 実施方法（Mode）

各工程を「どの設備で、どれくらいの時間で行うか」のパターンを設定します。

| 項目名 | 説明 | 入力上の注意 |
| --- | --- | --- |
| パターン名 | 「高速ライン使用」「手動ライン使用」などの名称。 | 1つの工程に複数登録可能です。 |
| 使用リソース | 使用する設備の番号。 | 事前に登録した設備を指定。 |
| 所要時間 | そのパターンで作業を行った際にかかる時間。 | 0以上の値を入力してください。 |
| 必要量 | 使用する各リソースの消費量または使用人数。 | 設備の最大容量を超えないよう注意。 |

## 3. 適用されるルール（制約条件）

計算時に考慮される主な制限事項です。

* **時間枠の厳守**: 各案件の着手可能日や完了期限、および各工程の時間枠を外れる計画は作成されません。
* **設備能力の超過禁止**: 同一時間帯に使用されるリソースの合計が、設定された最大容量を超えないように配慮されます。
* **工程間の順序関係**:
* 「工程Aが終わるまで工程Bを開始できない」といった前後関係。
* 「工程Aと工程Bは同じ設備で行う」といったリソースの固定。
* 「工程Aの直後に工程Bを間髪入れず行う」といった連続性の指定。


* **段取り替え時間**: 特定の設備で作業Aから作業Bに切り替える際、必要な準備（洗浄や型替え等）の時間が自動的に挿入されます。
* **実施パターンの選択**: 1つの工程に複数の実施方法がある場合、全体の効率が最も良くなる方法が1つ選ばれます。

## 4. 最適化の目的（出力結果）

以下の指標の優先度（重み）を調整することで、目的に応じた結果が得られます。

* **総工期（メイクスパン）の短縮**: 全ての作業が完了するまでの時間を最小限にします。
* **納期遅延の最小化**: 希望納期に対する遅れの合計や、遅延件数を最小限に抑えます。
* **段取り効率の向上**: 準備作業にかかる総時間を減らし、実稼働率を高めます。
* **コストの最適化**: 優先度の高い案件を早めに完了させ、全体の効率を最大化します。

計算終了後、各工程の開始・終了時刻が確定した「作業スケジュール表」および「設備稼働計画（ガントチャート）」が出力されます。

## 5. アプリケーション操作ガイド

### サイドバー設定
* **Instance Loader**:
    * **Select Instance**: "Sample Problem" またはフォルダ内のデータファイル（.sm, .mmなど）を選択します。
    * **Load Instance**: 選択した問題を読み込みます。
* **Solver Settings**:
    * **Time Limit (s)**: 計算時間の上限（秒）。
    * **Solve**: 最適化を実行します。

### 結果表示 (Optimization Results)
* **Schedule**: 各タスクの開始・終了時刻リスト。
* **Machine Gantt**: マシンごとの作業スケジュールをガントチャートで表示。
* **Task Gantt**: タスクIDごとのスケジュール表示。
* **Resource Usage**: リソースの使用率推移グラフ。